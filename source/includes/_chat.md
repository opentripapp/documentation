#Chat

Use `https://socket.opentripapp.com/` for access chat

## Get List Room
> Success Result

```json
{
    "error": false,
    "data":[
    {
                "_id": "5b2a212847f60e0019cf2c6c",
                "updatedAt": "2018-08-01T07:15:23.609Z",
                "createdAt": "2018-06-20T09:40:56.315Z",
                "type": "private",
                "all_members_are_administrators": true,
                "members": [
                    {
                        "user": {
                            "_id": "59cb719eec00de0010222d5a",
                            "name": "Kurniawan Yudha",
                            "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59cb719eec00de0010222d5a_e4e4069a961c39cd.jpg"
                        },
                        "status": "member",
                        "_id": "5b2a212847f60e0019cf2c6e",
                        "can_add_web_page_previews": true,
                        "can_send_other_messages": true,
                        "can_send_media_messages": true,
                        "can_send_messages": true,
                        "can_promote_members": true,
                        "can_pin_messages": true,
                        "can_restrict_members": true,
                        "can_invite_users": true,
                        "can_delete_messages": true,
                        "can_edit_messages": true,
                        "can_post_messages": true,
                        "can_change_info": true,
                        "can_be_edited": true,
                        "unread_count": 6
                    },
                    {
                        "user": {
                            "_id": "59c5c89665a538001088798f",
                            "name": "arizal saputro",
                            "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media-20f95100/media/59c5c89665a538001088798f_103a61372d1a1561.jpg"
                        },
                        "status": "creator",
                        "_id": "5b2a212847f60e0019cf2c6d",
                        "can_add_web_page_previews": true,
                        "can_send_other_messages": true,
                        "can_send_media_messages": true,
                        "can_send_messages": true,
                        "can_promote_members": true,
                        "can_pin_messages": true,
                        "can_restrict_members": true,
                        "can_invite_users": true,
                        "can_delete_messages": true,
                        "can_edit_messages": true,
                        "can_post_messages": true,
                        "can_change_info": true,
                        "can_be_edited": true,
                        "unread_count": 0
                    }
                ],
                "photo": {
                    "small_file_url": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59cb719eec00de0010222d5a_e4e4069a961c39cd.jpg",
                    "big_file_url": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59cb719eec00de0010222d5a_e4e4069a961c39cd.jpg"
                },
                "__v": 0,
                "last_message": "hoho",
                "last_message_date": "2018-08-01T07:15:23.603Z",
                "from": {
                    "_id": "59cb719eec00de0010222d5a",
                    "name": "Kurniawan Yudha",
                    "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59cb719eec00de0010222d5a_e4e4069a961c39cd.jpg"
                },
                "unread_count": 0
            },
            {
                        "_id": "5a96a4f75b31a360b6848aa4",
                        "updatedAt": "2018-08-01T07:15:13.069Z",
                        "createdAt": "2018-02-20T13:28:52.552Z",
                        "type": "group",
                        "title": "Open Trip Krakatau 17-18 Maret 2018",
                        "description": "Hai para pencari liburan, ayo join trip ke krakatau 17-18 maret ini bareng @santaisejenak.id detail dibawah yaa",
                        "all_members_are_administrators": true,
                        "invite_link": "9GVrn8dYHscJBUras",
                        "members": [
                            {
                                "user": {
                                    "_id": "5a68424404a9ca001262fa20",
                                    "name": "Rudi Anton",
                                    "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/5a68424404a9ca001262fa20_1424deb514b86430.jpg"
                                },
                                "status": "member",
                                "can_add_web_page_previews": true,
                                "can_send_other_messages": true,
                                "can_send_media_messages": true,
                                "can_send_messages": true,
                                "can_promote_members": true,
                                "can_pin_messages": true,
                                "can_restrict_members": true,
                                "can_invite_users": true,
                                "can_delete_messages": true,
                                "can_edit_messages": true,
                                "can_post_messages": true,
                                "can_change_info": true,
                                "can_be_edited": true,
                                "unread_count": 184
                            },
                            {
                                "user": {
                                    "_id": "5a5c658004a9ca001262f947",
                                    "name": "Bentar Septian",
                                    "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/5a5c658004a9ca001262f947_c62c250327ca591c"
                                },
                                "status": "creator",
                                "can_add_web_page_previews": true,
                                "can_send_other_messages": true,
                                "can_send_media_messages": true,
                                "can_send_messages": true,
                                "can_promote_members": true,
                                "can_pin_messages": true,
                                "can_restrict_members": true,
                                "can_invite_users": true,
                                "can_delete_messages": true,
                                "can_edit_messages": true,
                                "can_post_messages": true,
                                "can_change_info": true,
                                "can_be_edited": true,
                                "unread_count": 4
                            },
                            {
                                "user": {
                                    "_id": "59c63a5fe0bc2400117a87fc",
                                    "name": "Open Trip Official",
                                    "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59c63a5fe0bc2400117a87fc_81bba8be06307fce.jpg"
                                },
                                "status": "creator",
                                "can_add_web_page_previews": true,
                                "can_send_other_messages": true,
                                "can_send_media_messages": true,
                                "can_send_messages": true,
                                "can_promote_members": true,
                                "can_pin_messages": true,
                                "can_restrict_members": true,
                                "can_invite_users": true,
                                "can_delete_messages": true,
                                "can_edit_messages": true,
                                "can_post_messages": true,
                                "can_change_info": true,
                                "can_be_edited": true,
                                "unread_count": 4
                            },
                            {
                                "user": {
                                    "_id": "5a94c7a01fba58000f0bbdc8",
                                    "name": "Forrtuner"
                                },
                                "status": "creator",
                                "can_add_web_page_previews": true,
                                "can_send_other_messages": true,
                                "can_send_media_messages": true,
                                "can_send_messages": true,
                                "can_promote_members": true,
                                "can_pin_messages": true,
                                "can_restrict_members": true,
                                "can_invite_users": true,
                                "can_delete_messages": true,
                                "can_edit_messages": true,
                                "can_post_messages": true,
                                "can_change_info": true,
                                "can_be_edited": true,
                                "unread_count": 146
                            },
                            {
                                "user": {
                                    "_id": "59c5c89665a538001088798f",
                                    "name": "arizal saputro",
                                    "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media-20f95100/media/59c5c89665a538001088798f_103a61372d1a1561.jpg"
                                },
                                "status": "creator",
                                "can_add_web_page_previews": true,
                                "can_send_other_messages": true,
                                "can_send_media_messages": true,
                                "can_send_messages": true,
                                "can_promote_members": true,
                                "can_pin_messages": true,
                                "can_restrict_members": true,
                                "can_invite_users": true,
                                "can_delete_messages": true,
                                "can_edit_messages": true,
                                "can_post_messages": true,
                                "can_change_info": true,
                                "can_be_edited": true,
                                "unread_count": 0
                            }
                        ],
                        "photo": {
                            "small_file_url": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59c8721867db5c000f2b9ca7_a48967e412070c42.jpg",
                            "big_file_url": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59c8721867db5c000f2b9ca7_a48967e412070c42.jpg"
                        },
                        "last_message": "chat",
                        "last_message_date": "2018-08-01T07:15:13.060Z",
                        "__v": 0,
                        "unread_count": 0
                    },
                    ....
    ]
}
```
get user chat room list

### Endpoint

`GET /chat/list`

### Query Parameters
Parameter | Required | Example/Description
--------- | ------- | -----------
sort        | optional    | 'createdAt' 'last_message_date'
limit       | optional    | limit of data to get `10`  `15`
offset       | optional    | start to get data  `0` `15` `30`
type       | optional    | type of chat `group` `private`


## Get List Message
> Success Result

```json
{
    "error": false,
    "data":[
         {
                 "_id": "5b61638d495b90000f5bd4bb",
                 "updatedAt": "2018-08-01T07:38:53.701Z",
                 "createdAt": "2018-08-01T07:38:53.701Z",
                 "from": {
                     "_id": "59c5c89665a538001088798f",
                     "name": "arizal saputro",
                     "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media-20f95100/media/59c5c89665a538001088798f_103a61372d1a1561.jpg"
                 },
                 "chat_id": "5b2a212847f60e0019cf2c6c",
                 "text": "Ini",
                 "new_chat_members": [],
                 "photo": [],
                 "caption_entities": [],
                 "entities": [],
                 "read": false,
                 "__v": 0
             },
             ...
    ]
}
```

get message of chat

### Endpoint

`GET /chat/message/list`

### Query Parameters
Parameter | Required | Example/Description
--------- | ------- | -----------
chat_id       | true    | `_id` from room
limit       | optional    | limit of data to get `10`  `15`
offset       | optional    | start to get data  `0` `15` `30`


## Create Room
> Success Result

```json
{
    {
        "error": false,
        "data": {
            "_id": "5b6166c1495b90000f5bd4c1",
            "updatedAt": "2018-08-01T07:52:33.072Z",
            "createdAt": "2018-08-01T07:52:33.072Z",
            "title": "Krakatau Group",
            "type": "group",
            "all_members_are_administrators": false,
            "invite_link": "bW7rsNrCrW5OSZy8",
            "members": [
                {
                    "user": {
                        "_id": "59cb719eec00de0010222d5a",
                        "name": "Kurniawan Yudha",
                        "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media/59cb719eec00de0010222d5a_e4e4069a961c39cd.jpg"
                    },
                    "status": "member",
                    "_id": "5b6166c1495b90000f5bd4c3",
                    "can_add_web_page_previews": true,
                    "can_send_other_messages": true,
                    "can_send_media_messages": true,
                    "can_send_messages": true,
                    "can_promote_members": false,
                    "can_pin_messages": false,
                    "can_restrict_members": false,
                    "can_invite_users": false,
                    "can_delete_messages": true,
                    "can_edit_messages": true,
                    "can_post_messages": true,
                    "can_change_info": false,
                    "can_be_edited": true,
                    "unread_count": 0
                },
                {
                    "user": {
                        "_id": "59c5c89665a538001088798f",
                        "name": "arizal saputro",
                        "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media-20f95100/media/59c5c89665a538001088798f_103a61372d1a1561.jpg"
                    },
                    "status": "creator",
                    "_id": "5b6166c1495b90000f5bd4c2",
                    "can_add_web_page_previews": true,
                    "can_send_other_messages": true,
                    "can_send_media_messages": true,
                    "can_send_messages": true,
                    "can_promote_members": true,
                    "can_pin_messages": true,
                    "can_restrict_members": true,
                    "can_invite_users": true,
                    "can_delete_messages": true,
                    "can_edit_messages": true,
                    "can_post_messages": true,
                    "can_change_info": true,
                    "can_be_edited": true,
                    "unread_count": 0
                }
            ],
            "photo": {
                "small_file_url": "https://qiscuss3.s3.amazonaws.com/uploads/55c0c6ee486be6b686d52e5b9bbedbbf/2.png",
                "big_file_url": "https://qiscuss3.s3.amazonaws.com/uploads/55c0c6ee486be6b686d52e5b9bbedbbf/2.png"
            },
            "__v": 0,
            "unread_count": 0
        }
    }
}
```

user create 1-1 room or group room

### Endpoint

`POST /chat/create`

### Body Parameters
Parameter | Required | Example/Description
--------- | ------- | -----------
type      | true    | type of room `private` `group`
users     | true    | array of users `_id`
title     | optional | tittle of group room

> Example body

```json
{
  "type":"group",
  "users":["59cb719eec00de0010222d5a","5a94c7a01fba58000f0bbdc8"],
  "title":"Krakatau Group",
  "photo":{
      "small_fil_url":"https://qiscuss3.s3.amazonaws.com/uploads/55c0c6ee486be6b686d52e5b9bbedbbf/2.png"
  },
  "all_members_are_administrators":false
}

{
  "type":"private",
  "users":["59cb719eec00de0010222d5a"]
}
```


## Send Message
> Success Result

```json
{
    "error": false,
    "data": {
        "__v": 0,
        "updatedAt": "2018-08-01T08:06:29.218Z",
        "createdAt": "2018-08-01T08:06:29.218Z",
        "from": {
            "_id": "59c5c89665a538001088798f",
            "name": "arizal saputro",
            "profile_picture": "https://s3-ap-southeast-1.amazonaws.com/opentrip-media-20f95100/media/59c5c89665a538001088798f_103a61372d1a1561.jpg"
        },
        "chat_id": "5b2a212847f60e0019cf2c6c",
        "text": "Hello,i am send messages from api",
        "_id": "5b616a05495b90000f5bd4ce",
        "new_chat_members": [],
        "photo": [],
        "caption_entities": [],
        "entities": [],
        "read": false
    }
}
```

send message

### Endpoint

`POST /chat/send_message`

### Query Parameters
Parameter | Required | Example/Description
--------- | ------- | -----------
chat_id   | true    | `_id` of chat room
text   | true    | text message

